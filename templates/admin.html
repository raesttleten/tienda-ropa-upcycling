<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - thriftstorecol</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <header>
        <nav>
            <a href="/" class="logo">thriftstorecol · admin</a>
            <div class="nav-icons">
                <a href="/" style="width: auto; padding: 0.8rem 1.5rem; border-radius: 50px;">
                    <i class="fas fa-home"></i> Volver a la tienda
                </a>
            </div>
        </nav>
    </header>

    <main class="admin-container">
        <div class="admin-stats">
            <div class="stat-card">
                <h3>Total Productos</h3>
                <div class="numero">{{ total_productos }}</div>
            </div>
            <div class="stat-card">
                <h3>Stock Total</h3>
                <div class="numero">{{ total_stock }}</div>
            </div>
            <div class="stat-card">
                <h3>Valor Inventario</h3>
                <div class="numero">${{ "%.2f"|format(valor_inventario) }}</div>
            </div>
        </div>

        <section class="agregar-producto">
            <h2>Agregar Nueva Pieza</h2>
            <form method="POST" action="/admin/agregar">
                <input type="text" name="nombre" placeholder="Nombre del producto *" required>

                <select name="categoria" required>
                    <option value="">Seleccionar categoría *</option>
                    <option value="Camisas">Camisas</option>
                    <option value="Pantalones">Pantalones</option>
                    <option value="Faldas">Faldas</option>
                    <option value="Bolsos">Bolsos</option>
                    <option value="Accesorios">Accesorios</option>
                    <option value="Otro">Otro</option>
                </select>

                <input type="number" name="precio" placeholder="Precio (COP) *" required>

                <select name="talla" required>
                    <option value="">Seleccionar talla *</option>
                    <option value="XS">XS</option>
                    <option value="S">S</option>
                    <option value="M">M</option>
                    <option value="L">L</option>
                    <option value="XL">XL</option>
                    <option value="XXL">XXL</option>
                    <option value="Única">Única</option>
                </select>

                <input type="number" name="stock" placeholder="Stock disponible *" required min="0">

                <input type="url" name="imagen_url" placeholder="URL de la imagen *" required>

                <textarea name="descripcion" placeholder="Descripción: historia de la pieza, materiales, estado, detalles especiales..." required></textarea>

                <button type="submit">AGREGAR PRODUCTO</button>
            </form>

        </section>

        <section class="lista-productos">
            <h2>Inventario Actual</h2>
            {% if productos %}
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Imagen</th>
                        <th>Nombre</th>
                        <th>Categoría</th>
                        <th>Precio</th>
                        <th>Talla</th>
                        <th>Stock</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% for producto in productos %}
                    <tr>
                        <td><strong>#{{ producto.id }}</strong></td>
                        <td>
                            <img src="{{ producto.imagen_url }}" alt="{{ producto.nombre }}"
                                 style="width: 70px; height: 70px; object-fit: cover; border-radius: 4px; border: 1px solid var(--wine);"
                                 onerror="this.src='https://images.unsplash.com/photo-1445205170230-053b83016050?w=100&h=100&fit=crop'">
                        </td>
                        <td><strong>{{ producto.nombre }}</strong></td>
                        <td><span style="color: var(--light-wine);">{{ producto.categoria }}</span></td>
                        <td style="color: var(--wine); font-weight: 700; font-size: 1.1rem;">${{ "%.2f"|format(producto.precio) }}</td>
                        <td>{{ producto.talla }}</td>
                        <td>
                            {% if producto.stock == 0 %}
                                <span style="color: #8B0000;">Agotado</span>
                            {% elif producto.stock == 1 %}
                                <span style="color: var(--light-wine);">1 (única)</span>
                            {% elif producto.stock < 3 %}
                                <span style="color: var(--light-wine);">{{ producto.stock }}</span>
                            {% else %}
                                <span style="color: var(--light-gray);">{{ producto.stock }}</span>
                            {% endif %}
                        </td>
                        <td>
                            <a href="/admin/eliminar/{{ producto.id }}"
                               class="btn-delete"
                               onclick='return confirm("¿Seguro que quieres eliminar este producto?")'>
                                <i class="fas fa-trash"></i> Eliminar
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p style="text-align: center; color: var(--light-gray); padding: 3rem;">
                No hay productos. Agrega tu primera pieza vintage arriba.
            </p>
            {% endif %}
        </section>
    </main>

    <footer>
        <p>thriftstorecol · Admin Panel</p>
    </footer>
</body>
</html>